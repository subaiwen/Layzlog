## 地理数据抽样验收

![table](https://i.imgur.com/9a6tWud.png)

背景：

> 供应商提供酒店地理坐标，为证实其可靠度，进行分层抽样验收。主要验收距离分类<=1的数			据，反馈给开发1km内误差的酒店gps是否值得更新上去。

变量：

> 中文名：酒店中文名
> 原始经纬度：供应商提供的坐标（经纬度）

方法：分层抽样法

> 根据酒店的重要程度分三层：
>
> - 第一层：销量最高的酒店（体量较小，取>=2）和主推酒店（营销）中普查
> - 第二层：热门城市中随机抽样
> - 第三层：剩余的酒店中随机抽样

样本量确定：

- Theorm

> <img src="https://i.imgur.com/OyIJTGm.jpg" style="zoom:70%"/>

- Function in R:

> ```R
> getsample <- function(N,error,P,Z){
>   n = ((1.96^2)*N*(1-P)*P)/((N-1)*(error^2)*(P^2)+(1.96^2)*P*(1-P))
>   return(ceiling(n))
> } 
> # 确定样本量的公式:置信水平95%
> n <- getsample(N= nrow(df), error = 0.05, P = 0.95)
> #得到样本量
> sample_city <- df[sample(nrow(df), n), ]
> #得到样本数据集
> ```

工具：

> 链接：[http://www.gpsspg.com/latitude-and-longitude.htm](gps)
>
> 步骤：
>
> 1. 打开网页-左上角“经纬度”-输入框输入坐标
> 2. 左下角点选“硬件/谷歌地球卫星”
> 3. 右上角点选“高德”地图

---

### 验收报告

---

|          | 主推酒店及销量酒店 | 热门城市（前20）酒店 | 主推酒店及销量酒店 |
| -------- | ------------------ | -------------------- | ------------------ |
| 验收方法 | 普查               | 随机抽样             | 随机抽样           |
| 总体     | 51                 | 5363                 | 3664               |
| 样本量   | 51                 | 80                   | 43                 |
| 不合格数 | 4                  | 3                    | 4                  |
| 合格率   | 92.16%             | 96.25%               | 90.70%             |

**总结**：

- 总体合格率：93.68%
- 加权及格率：93.04%

**_结果：验收及格_**

---

1. 主推酒店及销量酒店：
> - 验收方法：普查
> - 总体：51（原总数98，与agoda列表合并后只能匹配到51个酒店）
> - 不合格数： 4
> - 合格率： 92.16%

2. 热门城市（前20）酒店：
> - 验收方法：随机抽样
> - 总体：5363
> - 样本量：80 (期望：95%，误差4.75%)
> - 不合格数：3
> - 合格率： 96.25%

3. 主推酒店及销量酒店：
> - 验收方法：随机抽样
> - 总体：3664
> - 样本量：43 (期望：90%，误差9%)
> - 不合格数：4
> - 合格率： 90.70%
